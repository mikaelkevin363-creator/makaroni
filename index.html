<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>OPEN PREâ€‘ORDER MAKARONI</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#e7f9fd; --bg2:#d7f3fb; --card:#fff; --accent:#0d86a9; --muted:#546e73; --price:#026c91;
    }
    *{boxâ€sizing:borderâ€box;fontâ€family:Poppins,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;}
    body{margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#04303a;padding:18px;}
    .wrap{maxâ€width:1000px;margin:0 auto}
    header{display:flex;alignâ€items:center;justifyâ€content:spaceâ€between;gap:12px;marginâ€bottom:16px}
    h1{margin:0;color:var(--accent);fontâ€size:22px}
    .lead{color:var(--muted)}
    .card{background:var(--card);borderâ€radius:12px;padding:14px;boxâ€shadow:0 8px 20px rgba(6,29,37,0.06)}
    .seg{display:flex;gap:8px}
    .seg button{border:none;padding:10px 14px;borderâ€radius:10px;cursor:pointer;fontâ€weight:600}
    .seg .active{background:var(--accent);color:#fff}
    .seg .inactive{background:#eef9fb;color:var(--accent)}
    .layout{display:grid;gridâ€templateâ€columns:1fr 360px;gap:16px;marginâ€top:12px}
    @media(maxâ€width:980px){.layout{gridâ€templateâ€columns:1fr}}
    label{display:block;fontâ€weight:600;marginâ€bottom:6px}
    input[type="text"], input[type="number"], select, textarea{width:100%;padding:10px;borderâ€radius:8px;border:1px solid #d7eef6;background:#fbfeff}
    .variants{marginâ€top:8px}
    .variant-row{display:flex;justifyâ€content:spaceâ€between;alignâ€items:center;padding:10px 6px;borderâ€bottom:1px dashed #eef7fa}
    .small{fontâ€size:13px;color:var(--muted)}
    .qty{width:92px;padding:8px;borderâ€radius:8px;border:1px solid #d7eef6;textâ€align:center}
    .summary{padding:12px;borderâ€radius:10px;background:linearâ€gradient(180deg,#f3fcff,#ffffff);border:1px solid #d8eef6}
    .total{fontâ€size:20px;fontâ€weight:700;color:var(--price);marginâ€top:8px}
    .btn{background:var(--accent);color:#fff;padding:10px 12px;borderâ€radius:10px;border:none;cursor:pointer;fontâ€weight:700;width:100%}
    .wa-btn{display:inlineâ€flex;gap:8px;alignâ€items:center;background:#25D366;color:white;padding:10px 12px;borderâ€radius:10px;textâ€decoration:none;fontâ€weight:700}
    .file-input{padding:8px;borderâ€radius:8px;border:1px dashed #cdeef8;background:#fbfeff}
    .map iframe{width:100%;height:220px;borderâ€radius:8px;border:0}
    .note{fontâ€size:13px;color:var(--muted);marginâ€top:6px}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>OPEN PREâ€‘ORDER MAKARONI</h1>
      <div class="small lead">All packs Rpâ€¯15.000 â€” pilih tipe pesanan, varian, dan jumlah</div>
    </div>
    <div style="textâ€align:right">
      <a class="wa-btn" id="waTop" href="#" target="_blank">Chat CP â€¢ 08813893900</a>
    </div>
  </header>
  <div class="card">
    <div style="display:flex;alignâ€items:center;gap:12px;flexâ€wrap:wrap">
      <div class="seg" role="tablist" ariaâ€label="Tipe Pesanan">
        <button id="tabS" class="seg-btn active" dataâ€type="Sedesian">Sedesian</button>
        <button id="tabR" class="seg-btn inactive" dataâ€type="Reguler">Reguler</button>
      </div>
      <div style="flex:1"></div>
      <div class="small">Contact person: Elâ€¯XIIB2 â€¢â€¯08813893900</div>
    </div>
    <div class="layout" style="marginâ€top:12px">
      <!-- LEFT: FORM -->
      <div>
        <form id="mainForm" class="card">
          <div id="fieldName">
            <label>Nama Lengkap</label>
            <input id="inputName" type="text" placeholder="Nama lengkap" required>
            <div id="classRow" style="marginâ€top:10px">
              <label>Kelas (untuk Sedesian)</label>
              <input id="inputClass" type="text" placeholder="e.g.â€¯XIIB2">
            </div>
            <div id="addressRow" style="marginâ€top:10px;display:none">
              <label>Alamat Lengkap (untuk Reguler delivery)</label>
              <textarea id="inputAddress" rows="2" placeholder="Alamat untuk pengiriman"></textarea>
              <div class="note">Jika pilih delivery, harap hubungi CP setelah submit untuk konfirmasi ongkir.</div>
            </div>
          </div>
          <div style="marginâ€top:12px">
            <label>Daftar Varian (Rpâ€¯15.000 / pack) â€” isi qty 0â€“10</label>
            <div class="variants" id="variantsList"></div>
            <div class="note">Max qty per variant: 10</div>
          </div>
          <div id="regulerOptions" style="marginâ€top:12px;display:none">
            <label>Opsi Pengambilan</label>
            <select id="pickupOption">
              <option value="pickup">Pickup di SMAâ€¯Sedesâ€¯Sapientiaeâ€¯Semarang (12:00)</option>
              <option value="delivery">Kirim ke alamat</option>
            </select>
          </div>
          <div style="marginâ€top:12px">
            <label>Metode Pembayaran</label>
            <div id="paymentArea" class="small"></div>
            <div style="marginâ€top:12px">
              <label>Upload Bukti (wajib jika pilih Transfer)</label>
              <div class="file-input">
                <input id="proofFile" name="bukti" type="file" accept="image/*,application/pdf" />
              </div>
            </div>
            <div style="marginâ€‘top:12px">
              <label>Catatan (opsional)</label>
              <input id="notes" type="text" placeholder="Contoh: ambil lebih awal jika bisa" />
            </div>
          </div>
          <div style="marginâ€‘top:12px;display:flex;gap:8px">
            <button type="button" id="btnSubmit" class="btn">Kirim</button>
          </div>
        </form>
      </div>
      <!-- RIGHT: SUMMARY -->
      <aside>
        <div class="summary card">
          <div class="small">Ringkasan Pesanan</div>
          <div id="orderSummary" class="small" style="marginâ€‘top:8px">Belum ada item dipilih</div>
          <div class="total" id="orderTotal">Rpâ€¯0</div>
          <div style="marginâ€‘top:12px">
            <button id="btnChat" class="btn" style="background:#25D366">Chat CP via WA</button>
          </div>
        </div>
        <div style="marginâ€‘top:12px" class="card map">
          <label>Lokasi Pickup</label>
          <iframe src="https://www.google.com/maps?q=SMA+SEDES+SAPIENTIAE+SEMARANG&output=embed"></iframe>
          <div class="note">Pickup default jam 12:00 â€” bisa dikonfirmasi dengan CP.</div>
        </div>
      </aside>
    </div>
  </div>
</div>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxz8XGmPdqYolRlmHyZxredVHKB0GUrSJIYhlT9QZx2/dev";
const CP_WA_NUMBER   = "628813893900";
const PRICE          = 15000;
const VARIANTS       = ["Original","Spicy","Super Spicy","Balado","BBQ","Keju","Keju Pedas","Sapi Panggang","Sapi Pedas","Jagung Bakar","Jagung Manis","Ayam Lada Hitam","Cokelat","Rumput Laut","Rumput Laut Pedas","Mie Goreng"];

const variantsList   = document.getElementById('variantsList');
VARIANTS.forEach(v => {
  const row = document.createElement('div');
  row.className = 'variant-row';
  row.innerHTML = `
    <div style="display:flex;gap:12px;align-items:center">
      <div style="font-weight:600">${v}</div>
      <div class="small" style="margin-left:6px;color:var(--price)">Rp ${PRICE.toLocaleString()}</div>
    </div>
    <div><input type="number" class="qty" min="0" max="10" value="0" data-variant="${v}" /></div>
  `;
  variantsList.appendChild(row);
});

const tabS         = document.getElementById('tabS'),
      tabR         = document.getElementById('tabR'),
      classRow     = document.getElementById('classRow'),
      addressRow   = document.getElementById('addressRow'),
      regulerOptions= document.getElementById('regulerOptions'),
      paymentArea  = document.getElementById('paymentArea'),
      proofFile    = document.getElementById('proofFile'),
      btnSubmit    = document.getElementById('btnSubmit'),
      orderSummary = document.getElementById('orderSummary'),
      orderTotal   = document.getElementById('orderTotal'),
      btnChat      = document.getElementById('btnChat'),
      waTop        = document.getElementById('waTop');

let currentType = 'Sedesian';

function showType(type){
  currentType = type;
  if (type === 'Sedesian') {
    tabS.classList.add('active'); tabS.classList.remove('inactive');
    tabR.classList.remove('active'); tabR.classList.add('inactive');
    classRow.style.display      = 'block';
    addressRow.style.display    = 'none';
    regulerOptions.style.display= 'none';
    renderPaymentOptions(['Transfer','Cash']);
  } else {
    tabR.classList.add('active'); tabR.classList.remove('inactive');
    tabS.classList.remove('active'); tabS.classList.add('inactive');
    classRow.style.display      = 'none';
    addressRow.style.display    = 'block';
    regulerOptions.style.display= 'block';
    renderPaymentOptions(['Transfer']);
  }
  updateSummary();
}

function renderPaymentOptions(list){
  paymentArea.innerHTML = '';
  list.forEach((m, idx) => {
    const wrap = document.createElement('div');
    wrap.style.marginBottom = '6px';
    wrap.innerHTML = `
      <label style="display:flex;align-items:center;gap:6px">
        <input type="radio" name="metode" value="${m}" ${idx===0?'checked':''}> ${m}
      </label>
      ${ m === 'Transfer'
        ? '<div class="small" style="margin-left:22px;color:var(--price)">ğŸ’³ Transfer ke: <br>â€¢ BCA 4090683361<br>â€¢ MANDIRI 1360036725569<br>a.n. <b>Mikael Kevin Kurnia</b></div>'
        : '<div class="small" style="margin-left:22px;color:var(--muted)">ğŸ’¬ Jika membayar Cash, harap segera hubungi CP untuk konfirmasi.</div>'
      }
    `;
    paymentArea.appendChild(wrap);
  });
}

function gatherItems(){
  const inputs = document.querySelectorAll('.qty');
  const items  = [];
  inputs.forEach(i=>{
    const q = Number(i.value) || 0;
    if (q > 0) {
      items.push({ variant: i.dataset.variant, qty: q, price: PRICE });
    }
  });
  return items;
}

function updateSummary(){
  const items = gatherItems();
  if (items.length === 0) {
    orderSummary.textContent = 'Belum ada item dipilih';
    orderTotal.textContent   = 'Rp 0';
    return;
  }
  const lines = items.map(it => `${it.variant} x${it.qty}`);
  const total = items.reduce((s,it) => s + it.qty*it.price, 0);
  orderSummary.textContent = lines.join(', ');
  orderTotal.textContent   = 'Rp ' + total.toLocaleString('idâ€‘ID');
}

tabS.onclick = () => showType('Sedesian');
tabR.onclick = () => showType('Reguler');

document.addEventListener('input', e => {
  if (e.target.classList.contains('qty')) {
    let v = Number(e.target.value) || 0;
    if (v < 0) v = 0;
    if (v > 10) v = 10;
    e.target.value = v;
    updateSummary();
  }
});

btnChat.onclick = () => window.open('https://wa.me/' + CP_WA_NUMBER + '?text=' + encodeURIComponent('Halo CP, saya mau tanya tentang preâ€‘order makaroni.'), '_blank');
waTop.href   = 'https://wa.me/' + CP_WA_NUMBER + '?text=' + encodeURIComponent('Halo CP, saya ingin info preâ€‘order makaroni.');

btnSubmit.onclick = async () => {
  const nama      = document.getElementById('inputName').value.trim();
  const kelas     = document.getElementById('inputClass').value.trim();
  const alamat    = document.getElementById('inputAddress').value.trim();
  const pickupOpt = document.getElementById('pickupOption') ? document.getElementById('pickupOption').value : null;
  const notes     = document.getElementById('notes').value.trim();

  if (!nama) return alert('Silakan isi nama.');
  if (currentType === 'Sedesian' && !kelas) return alert('Silakan isi kelas untuk Sedesian.');
  if (currentType === 'Reguler' && pickupOpt === 'delivery' && !alamat) return alert('Silakan isi alamat untuk pengiriman.');

  const items = gatherItems();
  if (items.length === 0) return alert('Pilih minimal 1 varian.');

  const metodeRadio = document.querySelector('input[name="metode"]:checked');
  if (!metodeRadio) return alert('Pilih metode pembayaran.');
  const metode = metodeRadio.value;
  const proofFileObj = proofFile.files[0];

  if (metode === 'Transfer' && !proofFileObj) return alert('Upload bukti transfer dulu.');

  const orderLines = items.map(it => `${it.variant} x${it.qty}`);
  const total      = items.reduce((s,it)=>s + it.qty*it.price, 0);
  const totalRp    = total.toLocaleString('idâ€‘ID');

  const fd = new FormData();
  fd.append('nama',  nama);
  fd.append('kelas', currentType==='Sedesian'?kelas:"");
  fd.append('alamat', currentType==='Reguler'?alamat:"");
  fd.append('tipe', currentType);
  fd.append('pesanan', orderLines.join('; '));
  fd.append('total', total);
  fd.append('metode', metode);
  fd.append('notes', notes || '');
  if (proofFileObj) fd.append('bukti', proofFileObj, proofFileObj.name);

  try {
    const resp = await fetch(APPS_SCRIPT_URL, { method:'POST', body: fd });
    const text = await resp.text();
    alert(`âœ… Pesanan terkirim!\nNama: ${nama}\nTipe: ${currentType}\nTotal: Rp ${totalRp}`);
  } catch(err) {
    console.error(err);
    alert('Gagal kirim data. Coba lagi later.');
  }

  document.getElementById('mainForm').reset();
  updateSummary();
};

showType('Sedesian');
updateSummary();
</script>

</body>
</html>
